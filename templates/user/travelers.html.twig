{% extends 'basebackoffice.html.twig' %}

{% block title %}Traveler List{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>ðŸ‘¥ Travelers</h2>
        <a href="{{ path('admin_travelers_statistics') }}" class="btn btn-outline-info">ðŸ“Š View Statistics</a>
    </div>

    <input type="text" id="searchInput" class="form-control mb-3" placeholder="Search travelers...">

    <table class="table table-bordered table-hover table-striped" id="travelersTable">
        <thead class="table-dark">
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Gender</th>
                <th>Age</th>
                <th>Country</th>
                <th>Phone</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in userData %}
                {% set user = entry.user %}
                <tr>
                    <td>{{ user.firstName }}</td>
                    <td>{{ user.lastName }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.gender }}</td>
                    <td>{{ entry.age is not null ? entry.age : 'N/A' }}</td>
                    <td>{{ user.country }}</td>
                    <td>{{ user.phoneNumber }}</td>
                    <td>
                        <form method="post" action="{{ path('user_delete', {'id': user.id}) }}" onsubmit="return confirm('Are you sure you want to delete this user?');">
                            <input type="hidden" name="_method" value="DELETE">
                            <button class="btn btn-sm btn-outline-danger">ðŸ—‘ Delete</button>
                        </form>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="8" class="text-center">No travelers found.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    const searchInput = document.getElementById('searchInput');
    const rows = document.querySelectorAll('#travelersTable tbody tr');

    searchInput.addEventListener('input', function () {
        const search = this.value.toLowerCase();
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(search) ? '' : 'none';
        });
    });
</script>
{% endblock %}
